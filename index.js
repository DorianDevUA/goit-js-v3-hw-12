var O=t=>{throw TypeError(t)};var x=(t,e,s)=>e.has(t)||O("Cannot "+s);var u=(t,e,s)=>(x(t,e,"read from private field"),s?s.call(t):e.get(t)),L=(t,e,s)=>e.has(t)?O("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),h=(t,e,s,a)=>(x(t,e,"write to private field"),a?a.call(t,s):e.set(t,s),s);import{a as w,S as U,i as E,H as _}from"./assets/vendor-DvBWQevJ.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const n of l)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function s(l){const n={};return l.integrity&&(n.integrity=l.integrity),l.referrerPolicy&&(n.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?n.credentials="include":l.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(l){if(l.ep)return;l.ep=!0;const n=s(l);fetch(l.href,n)}})();function R(){return{searchForm:document.querySelector(".js-gallery-search-form"),galleryContainer:document.querySelector(".js-gallery"),galleryGuard:document.querySelector(".js-guard-gallery"),loadMoreBtn:document.querySelector(".js-load-more-btn")}}class A{constructor({selector:e,enabledLabel:s,disabledLabel:a,hidden:l=!1}){this.refs=this.getRefs(e),this.enabledLabel=s,this.disabledLabel=a,l&&this.hide()}getRefs(e){const s={};return s.button=document.querySelector(e),s.label=s.button.querySelector(".custom-btn-label"),s.spinner=s.button.querySelector(".custom-btn-spinner"),s}enable(){this.refs.button.disabled=!1,this.refs.label.textContent=this.enabledLabel,this.refs.spinner.classList.add("is-hidden")}disable(){this.refs.button.disabled=!0,this.refs.label.textContent=this.disabledLabel,this.refs.spinner.classList.remove("is-hidden")}show(){this.refs.button.classList.remove("is-hidden")}hide(){this.refs.button.classList.add("is-hidden")}}w.defaults.baseURL="https://pixabay.com/api/";w.defaults.headers.common["Content-Type"]="application/json";const j="43520057-d4110ce2722b475a1deefaa82";var y,m,f;class D{constructor(){L(this,y);L(this,m);L(this,f);h(this,y,""),h(this,m,1),h(this,f,!1),this.limit=50}get searchQuery(){return u(this,y)}set searchQuery(e){h(this,y,e.trim().toLowerCase())}get isLastPage(){return u(this,f)}set isLastPage(e){h(this,f,e)}get galleryPage(){return u(this,m)}set galleryPage(e){h(this,m,e)}incrementPage(){h(this,m,u(this,m)+1)}resetPage(){h(this,m,1)}async fetchImages(){const e={method:"GET",params:{key:j,q:u(this,y),page:u(this,m),per_page:this.limit,image_type:"photo",orientation:"horizontal",safesearch:!0}};return w("",e).then(({data:s})=>{const a=Math.ceil(s.totalHits/this.limit);return h(this,f,u(this,m)>=a),console.log("Це остання сторінка?:",u(this,f)),u(this,f)?(console.log("This is last page. The End!"),s.hits):(this.incrementPage(),s.hits)})}}y=new WeakMap,m=new WeakMap,f=new WeakMap;class k{constructor(){this.lightbox=null}initialize(){const e=".js-gallery a",s={captions:!0,captionsData:"alt",captionDelay:250};this.lightbox=new U(e,s)}refresh(){this.lightbox.refresh()}}const N={BAD_REQUEST:"Введіть запит у поле для пошуку!",NOT_FOUND:"Sorry, there are no images matching your search query. Please try again!",END_OF_SEARCH:"We're sorry, but you've reached the end of search results."};function B(t){E.warning({position:"topRight",message:t})}function F(t){E.error({position:"topRight",message:t})}function H(t){E.info({position:"topRight",message:t})}const d={showWarningMsg:B,showErrorMsg:F,showInfoMsg:H,MESSAGES:N},Q=_.template({1:function(t,e,s,a,l){var n,r=e??(t.nullContext||{}),i=t.hooks.helperMissing,c="function",g=t.escapeExpression,o=t.lookupProperty||function(P,M){if(Object.prototype.hasOwnProperty.call(P,M))return P[M]};return"  <li class='gallery-item' data-id='"+g((n=(n=o(s,"id")||(e!=null?o(e,"id"):e))!=null?n:i,typeof n===c?n.call(r,{name:"id",hash:{},data:l,loc:{start:{line:2,column:36},end:{line:2,column:42}}}):n))+`'>
    <article class='card'>
      <div class='card-thumb'>
        <a class='card-link' href='`+g((n=(n=o(s,"largeImageURL")||(e!=null?o(e,"largeImageURL"):e))!=null?n:i,typeof n===c?n.call(r,{name:"largeImageURL",hash:{},data:l,loc:{start:{line:5,column:35},end:{line:5,column:52}}}):n))+`'>
          <img
            class='card-image'
            src='`+g((n=(n=o(s,"webformatURL")||(e!=null?o(e,"webformatURL"):e))!=null?n:i,typeof n===c?n.call(r,{name:"webformatURL",hash:{},data:l,loc:{start:{line:8,column:17},end:{line:8,column:33}}}):n))+`'
            alt='`+g((n=(n=o(s,"tags")||(e!=null?o(e,"tags"):e))!=null?n:i,typeof n===c?n.call(r,{name:"tags",hash:{},data:l,loc:{start:{line:9,column:17},end:{line:9,column:25}}}):n))+`'
            width='360'
            height='200'
          />
        </a>
      </div>

      <div class='card-content'>
        <ul class='card-socials'>
          <li>
            <h3>likes</h3>
            <p>`+g((n=(n=o(s,"likes")||(e!=null?o(e,"likes"):e))!=null?n:i,typeof n===c?n.call(r,{name:"likes",hash:{},data:l,loc:{start:{line:20,column:15},end:{line:20,column:24}}}):n))+`</p>
          </li>
          <li>
            <h3>views</h3>
            <p>`+g((n=(n=o(s,"views")||(e!=null?o(e,"views"):e))!=null?n:i,typeof n===c?n.call(r,{name:"views",hash:{},data:l,loc:{start:{line:24,column:15},end:{line:24,column:24}}}):n))+`</p>
          </li>
          <li>
            <h3>comments</h3>
            <p>`+g((n=(n=o(s,"comments")||(e!=null?o(e,"comments"):e))!=null?n:i,typeof n===c?n.call(r,{name:"comments",hash:{},data:l,loc:{start:{line:28,column:15},end:{line:28,column:27}}}):n))+`</p>
          </li>
          <li>
            <h3>downloads</h3>
            <p>`+g((n=(n=o(s,"downloads")||(e!=null?o(e,"downloads"):e))!=null?n:i,typeof n===c?n.call(r,{name:"downloads",hash:{},data:l,loc:{start:{line:32,column:15},end:{line:32,column:28}}}):n))+`</p>
          </li>
        </ul>
      </div>
    </article>
  </li>
`},compiler:[8,">= 4.3.0"],main:function(t,e,s,a,l){var n,r=t.lookupProperty||function(i,c){if(Object.prototype.hasOwnProperty.call(i,c))return i[c]};return(n=r(s,"each").call(e??(t.nullContext||{}),e,{name:"each",hash:{},fn:t.program(1,l,0),inverse:t.noop,data:l,loc:{start:{line:1,column:0},end:{line:38,column:9}}}))!=null?n:""},useData:!0}),G=R();function z(t){G.galleryContainer.insertAdjacentHTML("beforeend",Q(t))}function W(){G.galleryContainer.innerHTML=""}const S=R(),I=new IntersectionObserver(K,{root:null,rootMargin:"300px"});function K(t,e){console.log("entries:",t),t.forEach(s=>{s.isIntersecting&&(C(),console.log("call observer"))})}const p=new D,T=new k,v=new A({selector:".js-gallery-search-btn",enabledLabel:"Знайти",disabledLabel:"Пошук"}),b=new A({selector:".js-load-more-btn",enabledLabel:"Показати ще",disabledLabel:"Завантаження",hidden:!0});v.enable();S.searchForm.addEventListener("submit",Y);S.loadMoreBtn.addEventListener("click",C);async function Y(t){t.preventDefault();const e=t.currentTarget,s=e.elements.query.value.trim();if(!s){d.showWarningMsg(d.MESSAGES.BAD_REQUEST);return}p.searchQuery=s,$();try{await q(),T.initialize(),I.observe(S.galleryGuard)}catch(a){console.log(a)}v.enable(),e.reset()}async function C(){try{await q(),T.refresh()}catch(t){console.log(t)}}async function q(){b.disable(),console.log("call fillGullery");const t=await p.fetchImages();if(!!!t.length)return d.showErrorMsg(d.MESSAGES.NOT_FOUND),d.MESSAGES.NOT_FOUND;z(t),p.isLastPage?(d.showInfoMsg(d.MESSAGES.END_OF_SEARCH),console.log("перед видаленням"),I.unobserve(S.galleryGuard),b.hide()):(b.show(),b.enable())}function $(){p.resetPage(),p.isLastPage=!1,v.disable(),b.hide(),W()}
//# sourceMappingURL=index.js.map
